---
description:
globs:
alwaysApply: false
---
# SignalR é€šä¿¡æ¨¡å¼æŒ‡å—

## SignalR å®¢æˆ·ç«¯å®ç°
ä¸»è¦å®ç°åœ¨ [Services/SignalRClientService.cs](mdc:Services/SignalRClientService.cs) ä¸­ã€‚

## æ”¯æŒçš„ SignalR äº‹ä»¶

### ğŸ“¥ æ¥æ”¶çš„äº‹ä»¶ (ä»ä¸»æœåŠ¡å™¨)
- **StartServer** - å¯åŠ¨æ¸¸æˆæœåŠ¡å™¨
  - å‚æ•°: `StartServerCommand` JSON å­—ç¬¦ä¸²
  - å¤„ç†: è°ƒç”¨ `GameServerManager.StartServerAsync()`

- **StopServer** - åœæ­¢æ¸¸æˆæœåŠ¡å™¨
  - å‚æ•°: `StopServerCommand` JSON å­—ç¬¦ä¸²
  - å¤„ç†: è°ƒç”¨ `GameServerManager.StopServerAsync()`

- **QueryServers** - æŸ¥è¯¢æœåŠ¡å™¨ä¿¡æ¯
  - å‚æ•°: `QueryServerCommand` JSON å­—ç¬¦ä¸²
  - å¤„ç†: è¿”å›å•ä¸ªæˆ–æ‰€æœ‰æœåŠ¡å™¨ä¿¡æ¯

- **QueryNodeInfo** - æŸ¥è¯¢èŠ‚ç‚¹ä¿¡æ¯
  - å‚æ•°: æ— 
  - å¤„ç†: è¿”å›å½“å‰èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯

### ğŸ“¤ å‘é€çš„äº‹ä»¶ (åˆ°ä¸»æœåŠ¡å™¨)
- **RegisterNode** - æ³¨å†ŒèŠ‚ç‚¹
- **Heartbeat** - å¿ƒè·³åŒ… (æ¯30ç§’)
- **ServerStatusUpdate** - æœåŠ¡å™¨çŠ¶æ€æ›´æ–°
- **ServerInfo** - å•ä¸ªæœåŠ¡å™¨ä¿¡æ¯
- **ServerList** - æœåŠ¡å™¨åˆ—è¡¨
- **NodeInfo** - èŠ‚ç‚¹ä¿¡æ¯

## è¿æ¥ç®¡ç†
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- å¿ƒè·³ç›‘æ§
- è¿æ¥çŠ¶æ€äº‹ä»¶é€šçŸ¥
- é‡è¯•é€»è¾‘ (é…ç½®åœ¨ [appsettings.json](mdc:appsettings.json))

## é”™è¯¯å¤„ç†
- æ‰€æœ‰ SignalR äº‹ä»¶å¤„ç†éƒ½åŒ…è£…åœ¨ try-catch ä¸­
- è¿æ¥å¤±è´¥æ—¶çš„é‡è¯•é€»è¾‘
- æ—¥å¿—è®°å½•æ‰€æœ‰é€šä¿¡æ´»åŠ¨

## å‘½ä»¤æ¨¡å‹
æ‰€æœ‰å‘½ä»¤æ¨¡å‹å®šä¹‰åœ¨ [Models/Commands.cs](mdc:Models/Commands.cs) ä¸­ï¼Œä½¿ç”¨ JSON åºåˆ—åŒ–è¿›è¡Œä¼ è¾“ã€‚
